import{d as e,a4 as a,v as t,af as l,X as s,bd as u,be as o,r as i,a as r,o as n,c,w as d,b as f,g as p,k as v,t as m,bf as _,D as y,bg as b,p as x,j as h,b9 as g,a$ as I,bb as k,h as w,e as j,B as C,F as D,q as T,a5 as $,bh as z,H as F,ah as S,x as E,y as R,z as N,A as V,C as A,N as B,O as M,Q as O,ag as P,n as H}from"./index.ff1c4658.js";import{_ as U}from"./u-navbar.c1389b36.js";import{_ as q}from"./u-sticky.d8c10386.js";import{_ as Q}from"./u-button.8f2dbf84.js";import{t as W,a as X}from"./tabs.d2cc7fe2.js";import{_ as G}from"./u-empty.25fcdf2f.js";import{_ as J}from"./u-icon.5d484aeb.js";import{c as K,a as L,d as Y}from"./goods.17081166.js";import{_ as Z}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as ee}from"./mp-html.1c67fa6a.js";import{_ as ae}from"./u-popup.bf379202.js";import{C as te}from"./index.0b3ad6a7.js";import"./u-badge.b80b9ef4.js";import"./useTouch.e83eb469.js";var le=Z(e({__name:"l-audio",props:{src:{default:""},cataId:{default:0},courseId:{default:0},courseDetailInfo:{default:()=>{}},initialTime:{default:0}},emits:["refresh"],setup(e,{emit:g}){const I=e;let k=a({});const w=t(0),j=t(0),C=t(!1),D=t(!1);t(!1),l((()=>I.src),(e=>{const a=_();a.autoplay=!0,a.src=e,a.volume=1,a.startTime=I.initialTime,k=a,k.onCanplay((e=>{const a=setInterval((()=>{console.log("定时器循环"+k.duration),0!=k.duration&&(clearInterval(a),j.value=k.duration,setTimeout((()=>{k.play()}),0))}),500)})),k.onPlay((e=>{C.value=!0})),k.onTimeUpdate((e=>{B(),w.value=k.currentTime})),k.onWaiting((e=>{console.log("加载中")})),k.onPause((e=>{console.log("音频停止"),C.value=!1})),k.onEnded((e=>{console.log("播放完成"),C.value=!1})),k.onError((e=>{console.log("播放错误"),C.value=!1}))}),{immediate:!0}),l((()=>I.initialTime),(e=>{e>0&&uni.$u.toast("将跳转至上次播放的位置开始播放")}),{immediate:!0});const T=s((()=>{const e=w.value;return P(e)||"00:00"})),$=s((()=>{const e=j.value;return 0!=e&&O(),P(e)||"00:00"})),z=s((()=>w.value/j.value*100)),F=s((()=>I.courseDetailInfo.catalogue_list)),S=e=>{D.value=!1,w.value=e.detail.value/100*j.value,k.seek(w.value)},E=e=>{D.value=!0},R=()=>{C.value?O():M(),C.value=!C.value},N=()=>F.value.findIndex((e=>e.id==I.cataId)),V=()=>{const e=N();e+1!=F.value.length?g("refresh",F.value[e+1]):uni.$u.toast("已经是最后一章！")},A=()=>{const e=N();e-1<0?uni.$u.toast("已经是第一章！"):g("refresh",F.value[e-1])},B=u((()=>{K({catalogue_id:I.cataId,schedule:1*Math.floor(w.value)})}),2e3),M=()=>{k.play()},O=()=>{k.pause()},P=e=>{let a,t=parseInt(e/60/60%24);t=t<10?"0"+t:t;let l=parseInt(e/60%60);l=l<10?"0"+l:l;let s=parseInt(e%60);return s=s<10?"0"+s:s,a=`${"00"==t?"":t+":"}${l}:${s}`,a};return o((()=>{k.destroy(),console.log("组件销毁！！！！")})),(a,t)=>{const l=y,s=b,u=x,o=h,_=i(r("u-icon"),J);return n(),c(o,{class:"px-[68rpx] audio"},{default:d((()=>[f(l,{class:"w-full h-[330rpx] rounded-lg",src:e.courseDetailInfo.cover},null,8,["src"]),f(s,{value:p(z),activeColor:"#2073F4",backgroundColor:"#B1CFFF","block-color":"#2073F4",onChange:S,onChanging:E,"block-size":12,min:"0",max:"100"},null,8,["value"]),f(o,{class:"flex justify-between mt-[20rpx]"},{default:d((()=>[f(u,null,{default:d((()=>[v(m(p(T)),1)])),_:1}),f(u,null,{default:d((()=>[v(m(p($)),1)])),_:1})])),_:1}),f(o,{class:"flex justify-center items-center"},{default:d((()=>[f(o,{onClick:A},{default:d((()=>[f(_,{name:"rewind-left-fill",size:"32"})])),_:1}),f(o,{class:"mx-[30rpx] control w-[64rpx] h-[64rpx] bg-primary rounded-full flex items-center justify-center text-white pl-[5rpx]",onClick:R},{default:d((()=>[C.value?(n(),c(_,{key:0,name:"pause",size:"32"})):(n(),c(_,{key:1,name:"play-right-fill",size:"32"}))])),_:1}),f(o,{onClick:V},{default:d((()=>[f(_,{name:"rewind-right-fill",size:"32"})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-26e8e225"]]);const se=e({__name:"l-video",props:{src:{type:String,default:""},initialTime:{type:Number,default:0},cataId:{type:Number,default:-1},courseId:{type:Number,default:-1}},emits:["end","pause"],setup(e,{emit:a}){const s=e,o=I(),i=g("myVideo",o),r=t(0);l((()=>s.initialTime),(e=>{r.value=e,e>0&&(uni.$u.toast("即将跳转到上次播放的位置"),setTimeout((()=>{i.play()}),2e3))}),{immediate:!0});const p=e=>{a("pause"),v()},v=()=>{K({catalogue_id:s.cataId,schedule:1*r.value})},m=u(v,4e3),_=e=>{r.value=Math.floor(e.detail.currentTime),m()},y=()=>{r.value=0,a("end")};return(a,t)=>{const l=k,s=h;return n(),c(s,{class:"w-full"},{default:d((()=>[f(l,{class:"w-full h-[400rpx]",id:"myVideo",src:e.src,controls:"","initial-time":r.value,onPause:p,onTimeupdate:_,onEnded:y},null,8,["src","initial-time"])])),_:1})}}}),ue=e({__name:"I-text",props:{courseData:{default:()=>{}},cataId:{default:0},courseId:{default:0},courseDetailInfo:{default:()=>{}}},setup:e=>(a,t)=>{const l=h,s=i(r("mp-html"),ee);return n(),c(l,{class:"pt-[150rpx] mx-[20rpx]"},{default:d((()=>[w("图文课程顶部显示标题"),f(l,{class:"course-info"},{default:d((()=>[w(" 课程名称 "),f(l,{class:"text-xl font-medium flex-1"},{default:d((()=>{var a;return[v(m(null==(a=e.courseData)?void 0:a.name),1)]})),_:1}),w(" 介绍 "),f(l,{class:"text-muted mt-[18rpx] text-sm"},{default:d((()=>{var a,t,l;return[v(m(null==(a=e.courseDetailInfo)?void 0:a.create_time)+" "+m(null==(l=null==(t=e.courseDetailInfo)?void 0:t.teacher)?void 0:l.name),1)]})),_:1})])),_:1}),w(" 图文 "),f(l,{class:"bg-white p-[30rpx]"},{default:d((()=>[f(s,{content:e.courseData.content},null,8,["content"])])),_:1})])),_:1})}});var oe=Z(e({__name:"ITbottom",props:{courseDetailInfo:{type:Object,default:()=>{}},cateId:{type:[Number,String],default:0}},emits:["refresh"],setup(e,{emit:a}){const l=e,u=t(!1),o=()=>{u.value=!0},c=s((()=>l.courseDetailInfo.catalogue_list)),p=e=>{a("refresh",e),u.value=!1},m=()=>c.value.findIndex((e=>e.id==l.cateId)),_=()=>{const e=m();e-1<0?uni.$u.toast("已经是第一章！"):p(c.value[e-1])},y=()=>{const e=m();e+1!=c.value.length?p(c.value[e+1]):uni.$u.toast("已经是最后一章！")};return(a,t)=>{const l=i(r("u-icon"),J),s=x,c=h,m=T,b=i(r("u-popup"),ae);return n(),j(D,null,[f(c,{class:"flex h-[150rpx] items-center",style:{"border-top":"1px solid #e2e2e2"}},{default:d((()=>[f(c,{class:"w-1/3 text-center",onClick:_},{default:d((()=>[f(l,{name:"arrow-left",color:"#2979ff",size:"28"}),f(s,null,{default:d((()=>[v("上一章")])),_:1})])),_:1}),f(c,{class:"w-1/3 text-center mid",onClick:C(o,["stop"])},{default:d((()=>[v("目录")])),_:1},8,["onClick"]),f(c,{class:"w-1/3 text-center",onClick:y},{default:d((()=>[f(s,null,{default:d((()=>[v("下一章")])),_:1}),f(l,{name:"arrow-right",color:"#2979ff",size:"28"})])),_:1})])),_:1}),f(b,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),"safe-area-inset-bottom":"",mode:"bottom",height:"800rpx","border-radius":"20",closeable:""},{default:d((()=>[f(c,null,{default:d((()=>[f(c,{class:"h-[100rpx] text-center leading-[100rpx] text-2xl font-medium"},{default:d((()=>[v("目录")])),_:1}),f(c,{class:"h-[600rpx]"},{default:d((()=>[f(m,{"scroll-y":"",class:"h-full"},{default:d((()=>[w(' <course-catalogue\n                        :list="courseDetailInfo.courseCatalogues"\n                        :type="courseDetailInfo.type"\n                        :status="courseDetailInfo.purchased"\n                        :cateId="cateId"\n                        @refresh="handleRefresh"\n                    >\n                    </course-catalogue> '),f(te,{list:e.courseDetailInfo.catalogue_list,type:e.courseDetailInfo.type,status:e.courseDetailInfo.course_status,cateId:e.cateId,onRefresh:p},null,8,["list","type","status","cateId"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-20f0205e"]]);var ie=Z(e({__name:"index",setup(e){const a=t({id:0,course_id:0,name:"",fee_type:0,cover:"",content:"",schedule:0}),l=t({course_status:0,catalogue_list:[]}),u=t(!0),o=t(!1),_=t(""),y=t(""),b=t(),x=t(0),g=t(0),I=t(0),k=t(!1),C=$();s((()=>C.token));const T=s((()=>e=>{switch(e){case 1:return 0;case 2:case 3:return 400}})),J=async()=>{B({title:"载入中",mask:!0});try{o.value=!1;const e=await Y({id:y.value,course_id:_.value});a.value=e}catch(e){o.value=!0,console.log(e)}M()},K=e=>{e.id!=y.value&&(b.value=e,_.value=e.course_id,y.value=e.id,J(),O({scrollTop:0,duration:100}))},Z=()=>{P()},ee=()=>{k.value=!1};return z((({scrollTop:e})=>{if(1==g.value){k.value=!0;const a=F(100);I.value=e/a>1?1:e/a}})),S((e=>{g.value=e.type,1!=g.value&&(I.value=1),y.value=e.cate_id,_.value=e.course_id})),E((()=>{(async()=>{try{l.value=await L({id:_.value})}catch(e){console.log("获取课程详情=> ",e),u.value=!1}})(),J()})),(e,t)=>{const s=h,_=i(r("u-navbar"),U),C=i(r("u-sticky"),q),$=i(r("u-button"),Q),z=i(r("tab"),W),F=i(r("tabs"),X),S=i(r("u-empty"),G);return n(),j(D,null,[R(f(s,{class:"study-course safeArea",onClick:ee},{default:d((()=>[f(s,null,{default:d((()=>[f(_,{"is-back":I.value,background:{background:`rgba(255,255,255,${I.value})`},"border-bottom":!1,immersive:1==g.value},{default:d((()=>[f(s,{class:"w-[400rpx] overflow-hidden whitespace-nowrap text-ellipsis",style:V([{color:`rgba(0,0,0,${I.value})`},{"min-width":"0"}])},{default:d((()=>{var e,t;return[v(m((null==(e=b.value)?void 0:e.name)||(null==(t=a.value)?void 0:t.name)),1)]})),_:1},8,["style"])])),_:1},8,["is-back","background","immersive"])])),_:1}),w(" 课程信息 "),f(s,{class:"course bg-white"},{default:d((()=>[w(" 音频 "),2!=g.value||o.value?w("v-if",!0):(n(),c(s,{key:0,class:"h-[600rpx]"},{default:d((()=>[f(C,{enable:!0,"offset-top":0,"h5-nav-height":0},{default:d((()=>[f(s,{class:"p-[40rpx]"},{default:d((()=>[y.value==a.value.id?(n(),c(le,{key:0,src:a.value.content,"cata-id":a.value.id,"course-id":a.value.course_id,"initial-time":a.value.schedule,"course-detail-info":l.value,onRefresh:K},null,8,["src","cata-id","course-id","initial-time","course-detail-info"])):w("v-if",!0)])),_:1})])),_:1})])),_:1})),w(' <view v-else class="flex w-full h-[400rpx] justify-center items-center">\n                    <u-button type="primary" @click="backToBuy" shape="circle" class=""\n                        >购买课程</u-button\n                    >\n                </view> '),w(" 视频 "),3!=g.value||o.value?w("v-if",!0):(n(),c(s,{key:1,class:"h-[400rpx] bg-black"},{default:d((()=>[y.value==a.value.id?(n(),c(se,{key:0,src:a.value.content,"initial-time":a.value.schedule,"cata-id":a.value.id,"course-id":a.value.course_id},null,8,["src","initial-time","cata-id","course-id"])):w("v-if",!0)])),_:1})),1!=g.value||o.value?w("v-if",!0):(n(),c(s,{key:2},{default:d((()=>[y.value==a.value.id?(n(),c(ue,{key:0,courseData:a.value,"cata-id":a.value.id,"course-id":a.value.course_id,"course-detail-info":l.value},null,8,["courseData","cata-id","course-id","course-detail-info"])):w("v-if",!0)])),_:1})),o.value?(n(),c(s,{key:3,class:"flex w-full h-[400rpx] justify-center items-center"},{default:d((()=>[f($,{type:"primary",onClick:Z,shape:"circle",class:""},{default:d((()=>[v("购买课程")])),_:1})])),_:1})):w("v-if",!0)])),_:1}),w("图文目录"),1==g.value?(n(),c(s,{key:0,class:A(["bottom-0 px-[20rpx] safeArea fixed w-full bg-white",{"opacity-0":k.value}])},{default:d((()=>[f(oe,{"cate-id":y.value,"course-detail-info":l.value,onRefresh:K},null,8,["cate-id","course-detail-info"])])),_:1},8,["class"])):w("v-if",!0),w(" 课程目录 "),1!=g.value?(n(),c(s,{key:1,class:"mt-[30rpx]"},{default:d((()=>[f(F,{current:x.value,fontSize:"32",height:"100","bar-width":"60",inactiveColor:"#888888",top:p(T)(g.value),isFixed:"",tabsStyle:{"border-bottom":"1px solid #F6F6F6"},barStyle:{bottom:"-2rpx"},barHeight:"6"},{default:d((()=>[f(z,{name:"目录",i:1,index:x.value},{default:d((()=>[f(s,{style:{"min-height":"700rpx"}},{default:d((()=>[f(te,{list:l.value.catalogue_list,type:l.value.type,status:l.value.course_status,cateId:y.value,onRefresh:K},null,8,["list","type","status","cateId"])])),_:1})])),_:1},8,["index"])])),_:1},8,["current","top"])])),_:1})):w("v-if",!0),w(" Main End ")])),_:1},512),[[N,u.value]]),w(" empty Start "),R(f(s,{class:"empty"},{default:d((()=>[f(S,{text:"抱歉，该课程不存在~",src:"/static/images/empty/collection.png","icon-size":300,color:"#888888"},{bottom:d((()=>[f(s,{class:"empty-bottom"},{default:d((()=>[f($,{onClick:t[0]||(t[0]=e=>{H({url:"/pages/index/index"})}),shape:"circle",ripple:!0,"hair-line":!1,type:"primary"},{default:d((()=>[v(" 去看看其它")])),_:1})])),_:1})])),_:1},8,["src"])])),_:1},512),[[N,!u.value]]),w(" empty End "),w(" 购买课程弹窗 Start "),w(' <u-popup v-model="buyCourse" mode="center" borderRadius="14" :mask-close-able="false">\n        <view class="course-pop text-center">\n            <view class="text-lg font-medium normal pt-[45rpx] pb-[40rpx]"\n                >抱歉，您还未加入过该课程</view\n            >\n            <view class="flex justify-between mt-[60rpx]">\n                <u-button\n                    @click="handleOrder"\n                    class="flex-1"\n                    :ripple="true"\n                    shape="circle"\n                    :hair-line="false"\n                    type="primary"\n                    >去购买</u-button\n                >\n                <u-button\n                    @click="buyCourse = false"\n                    class="flex-1 m-l-30"\n                    :ripple="true"\n                    shape="circle"\n                    :hair-line="false"\n                    type="gary"\n                    >取消</u-button\n                >\n            </view>\n        </view>\n    </u-popup> '),w(" 购买课程弹窗 End ")],64)}}}),[["__scopeId","data-v-426daa61"]]);export{ie as default};
