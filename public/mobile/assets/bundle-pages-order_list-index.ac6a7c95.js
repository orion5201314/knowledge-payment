import{d as e,v as a,bA as t,r as s,a as r,o,c as l,w as n,h as d,b as u,k as i,t as c,e as f,f as m,F as p,l as _,B as b,n as y,j as v,p as g,bd as x,a5 as h,s as j,X as k,af as I,b1 as w,g as z,x as C,ah as S}from"./index.ff1c4658.js";import{t as E,a as F}from"./tabs.d2cc7fe2.js";import{_ as R}from"./z-paging.03bb45d3.js";import{_ as T}from"./u-button.8f2dbf84.js";import{_ as V}from"./u-empty.25fcdf2f.js";import{b as B}from"./order.ea379cbb.js";import{_ as H}from"./u-image.85f4d24b.js";import{_ as L}from"./u-count-down.676ebabe.js";import{P as M}from"./index.025f3805.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import{_ as A}from"./index.54b0eab2.js";import"./u-badge.b80b9ef4.js";import"./u-sticky.d8c10386.js";import"./useTouch.e83eb469.js";import"./u-icon.5d484aeb.js";var D=$(e({__name:"order-card",props:{orderInfo:{default:{}}},emits:["refresh"],setup(e,{emit:x}){const h=e,j=a(0);t((()=>{const e=h.orderInfo.cancel_time,a=(new Date).getTime()/1e3;j.value=1e3*(e-a)}));const k=()=>{j.value=0,x("refresh")},I=()=>{y({url:`/bundle/pages/order_detail/index?id=${h.orderInfo.id}`})};return(a,t)=>{const y=v,x=s(r("u-image"),H),h=s(r("u-count-down"),L),w=g;return o(),l(y,{class:"card",onClick:b(I,["stop"])},{default:n((()=>[d(" Header Start "),u(y,{class:"card--header flex justify-between"},{default:n((()=>[u(y,{class:"order-sn"},{default:n((()=>[i("订单编号："+c(e.orderInfo.sn),1)])),_:1}),u(y,{class:"status"},{default:n((()=>[i(c(e.orderInfo.order_status_desc),1)])),_:1})])),_:1}),d(" Header End "),d(" Main Start "),(o(!0),f(p,null,m(e.orderInfo.order_course,(a=>(o(),l(y,{key:a.id,class:"card--main flex"},{default:n((()=>[u(x,{src:a.course_snap.cover,width:"250",height:"160",borderRadius:"10"},null,8,["src"]),u(y,{class:"ml-[20rpx] order-text"},{default:n((()=>[u(y,{class:"order-text--name line-2"},{default:n((()=>[i(c(a.course_snap.name),1)])),_:2},1024),u(y,{class:"mt-[19rpx]"},{default:n((()=>[u(M,{content:e.orderInfo.order_amount,mainSize:"36rpx",minorSize:"34rpx",fontWeight:"500"},null,8,["content"])])),_:1})])),_:2},1024)])),_:2},1024)))),128)),d(" Main End "),d(" Footer Start "),u(y,{class:"card--footer flex justify-between items-center"},{default:n((()=>[d(" Left Tips "),u(y,{class:"primary"},{default:n((()=>[j.value?(o(),f(p,{key:0},[j.value>=0?(o(),l(y,{key:0,class:"flex items-center"},{default:n((()=>[u(h,{timestamp:j.value,format:"mm:ss","separator-size":26,onEnd:k,color:"#2073F4",class:"text-primary font-normal text-sm"},null,8,["timestamp"]),u(w,{class:"ml-[10rpx] primaryColor"},{default:n((()=>[i("后自动取消")])),_:1})])),_:1})):d("v-if",!0)],64)):d("v-if",!0)])),_:1}),d(" Right Button "),u(y,null,{default:n((()=>[_(a.$slots,"default",{},void 0,!0)])),_:3})])),_:3}),d(" Footer End ")])),_:3},8,["onClick"])}}}),[["__scopeId","data-v-4bf2a5d9"]]);const N=x((function(){y({url:"/pages/login/login"})}),2e3);var P=$(e({__name:"order-list",props:{type:{default:1},i:{default:0},index:{default:0}},setup(e){const t=e,c=h(),_=a([]),b=j(),y=k((()=>c.token)),g=()=>{console.log(1),b.value.refresh()},x=a(!0);I((()=>t.index),(async()=>{var e;await w(),t.i==t.index&&z(x)&&(x.value=!1,null==(e=b.value)||e.reload())}),{immediate:!0});const S=async(e,a)=>{try{const{lists:s}=await B({page_no:e,page_size:a,type:t.type});b.value.complete(s)}catch(s){console.log("下拉加载",s),b.value.complete(!1)}};return C((async()=>{await w(),b.value.refresh()})),(a,t)=>{const c=s(r("z-paging"),R),x=s(r("u-button"),T),h=v,j=s(r("u-empty"),V);return o(),f(p,null,[z(y)?(o(),l(c,{key:0,"auto-show-back-to-top":"",auto:e.i==e.index,ref_key:"paging",ref:b,modelValue:_.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),"data-key":e.i,onQuery:S,fixed:!1,height:"100%"},{default:n((()=>[(o(!0),f(p,null,m(_.value,((e,a)=>(o(),f(p,{key:e.id},[d(" 订单卡片 "),u(D,{orderInfo:e,onRefresh:g},{default:n((()=>[u(A,{orderId:null==e?void 0:e.id,cancel:e.cancel_btn,evaluate:e.comment_btn,pay:e.pay_btn,del:e.del_btn,onRefresh:g},null,8,["orderId","cancel","evaluate","pay","del"])])),_:2},1032,["orderInfo"])],64)))),128))])),_:1},8,["auto","modelValue","data-key"])):d("v-if",!0),d(" 未登录 "),z(y)?d("v-if",!0):(o(),l(h,{key:1,class:"empty"},{default:n((()=>[u(j,{src:"/static/images/empty/order.png",text:"您还没有登录～",mode:"data","icon-size":300,"margin-top":"300",color:"#888888"},{bottom:n((()=>[u(h,{class:"m-t-30"},{default:n((()=>[u(x,{onClick:z(N),shape:"circle",ripple:!0,"hair-line":!1,type:"info"},{default:n((()=>[i(" 去登录")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["src"])])),_:1}))],64)}}}),[["__scopeId","data-v-0cef7c60"]]);var Q=$(e({__name:"index",setup(e){const t=a([{name:"全部",type:0},{name:"待支付",type:1},{name:"已完成",type:2},{name:"已关闭",type:3}]),d=a(0),i=e=>{d.value=Number(e)};return S((e=>{d.value=1*(null==e?void 0:e.type)||0})),(e,a)=>{const c=v,_=s(r("tab"),E),b=s(r("tabs"),F);return o(),l(c,{class:"order-list"},{default:n((()=>[u(b,{current:d.value,onChange:i,height:"80","bar-width":"60","is-scroll":!1},{default:n((()=>[(o(!0),f(p,null,m(t.value,((e,a)=>(o(),l(_,{key:a,name:e.name},{default:n((()=>[u(c,{class:"orderList"},{default:n((()=>[u(P,{type:e.type,i:a,index:d.value},null,8,["type","i","index"])])),_:2},1024)])),_:2},1032,["name"])))),128))])),_:1},8,["current"])])),_:1})}}}),[["__scopeId","data-v-b063c9b6"]]);export{Q as default};
